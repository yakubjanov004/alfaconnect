
ALFABOT DATABASE ANALYSIS REPORT
Generated on: 2025-10-03 17:07:51
================================================================================

DATABASE SUMMARY
==================================================
Total tables: 15
Total rows: 25
Largest table: connection_orders (17 rows)
ENUM types: 7


================================================================================
DATABASE STRUCTURE ANALYSIS
================================================================================
Total tables found: 15

ENUM TYPES:
--------------------------------------------------
  business_type:
    - B2B
    - B2C

  connection_order_status:
    - in_manager
    - in_junior_manager
    - in_controller
    - in_technician
    - in_repairs
    - in_warehouse
    - in_technician_work
    - completed
    - between_controller_technician

  smart_service_category:
    - aqlli_avtomatlashtirilgan_xizmatlar
    - xavfsizlik_kuzatuv_tizimlari
    - internet_tarmoq_xizmatlari
    - energiya_yashil_texnologiyalar
    - multimediya_aloqa_tizimlari
    - maxsus_qoshimcha_xizmatlar

  staff_order_status:
    - new
    - in_call_center_operator
    - in_call_center_supervisor
    - in_manager
    - in_junior_manager
    - in_controller
    - in_technician
    - in_diagnostics
    - in_repairs
    - in_warehouse
    - in_technician_work
    - completed
    - between_controller_technician

  technician_order_status:
    - in_controller
    - in_technician
    - in_diagnostics
    - in_repairs
    - in_warehouse
    - in_technician_work
    - completed
    - between_controller_technician
    - in_call_center_supervisor
    - in_call_center_operator

  type_of_zayavka:
    - connection
    - technician

  user_role:
    - admin
    - client
    - manager
    - junior_manager
    - controller
    - technician
    - warehouse
    - callcenter_supervisor
    - callcenter_operator

TABLE: akt_documents
Row count: 0
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('akt...
request_id                bigint                    NULL                      
request_type              text                      NULL                      
akt_number                text                      NOT NULL                  
file_path                 text                      NOT NULL                  
file_hash                 text                      NOT NULL                  
sent_to_client_at         timestamp with time zone  NULL                      
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - akt_documents_pkey: CREATE UNIQUE INDEX akt_documents_pkey ON public.akt_documents ...

CONSTRAINTS:
  - CHECK: 2200_100800_1_not_null
  - CHECK: 2200_100800_4_not_null
  - CHECK: 2200_100800_5_not_null
  - CHECK: 2200_100800_6_not_null
  - CHECK: 2200_100800_8_not_null
  - CHECK: 2200_100800_9_not_null
  - CHECK: akt_documents_request_type_check
  - PRIMARY KEY: akt_documents_pkey

================================================================================

TABLE: akt_ratings
Row count: 0
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('akt...
request_id                bigint                    NULL                      
request_type              text                      NULL                      
rating                    integer                   NULL                      
comment                   text                      NULL                      
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - akt_ratings_pkey: CREATE UNIQUE INDEX akt_ratings_pkey ON public.akt_ratings ...

CONSTRAINTS:
  - CHECK: 2200_100813_1_not_null
  - CHECK: 2200_100813_6_not_null
  - CHECK: 2200_100813_7_not_null
  - CHECK: akt_ratings_rating_check
  - CHECK: akt_ratings_request_type_check
  - PRIMARY KEY: akt_ratings_pkey

================================================================================

TABLE: connection_orders
Row count: 17
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('con...
application_number        character varying(50)     NULL                      
user_id                   bigint                    NULL                      
region                    text                      NULL                      
address                   text                      NULL                      
tarif_id                  bigint                    NULL                      
business_type             USER-DEFINED              NOT NULL   'B2C'::busin...
longitude                 double precision          NULL                      
latitude                  double precision          NULL                      
jm_notes                  text                      NULL                      
is_active                 boolean                   NOT NULL   true           
status                    USER-DEFINED              NOT NULL   'in_manager'...
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - connection_orders_pkey: CREATE UNIQUE INDEX connection_orders_pkey ON public.connection_orders ...
  - idx_connection_orders_user: CREATE INDEX idx_connection_orders_user ON public.connection_orders ...
  - idx_connection_orders_status: CREATE INDEX idx_connection_orders_status ON public.connection_orders ...
  - idx_connection_orders_created: CREATE INDEX idx_connection_orders_created ON public.connection_orders ...

FOREIGN KEYS:
  - user_id -> users.id
  - tarif_id -> tarif.id

CONSTRAINTS:
  - CHECK: 2200_100516_11_not_null
  - CHECK: 2200_100516_12_not_null
  - CHECK: 2200_100516_13_not_null
  - CHECK: 2200_100516_14_not_null
  - CHECK: 2200_100516_1_not_null
  - CHECK: 2200_100516_7_not_null
  - PRIMARY KEY: connection_orders_pkey

================================================================================

TABLE: connections
Row count: 0
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('con...
sender_id                 bigint                    NULL                      
recipient_id              bigint                    NULL                      
connection_id             bigint                    NULL                      
technician_id             bigint                    NULL                      
staff_id                  bigint                    NULL                      
sender_status             text                      NULL                      
recipient_status          text                      NULL                      
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - connections_pkey: CREATE UNIQUE INDEX connections_pkey ON public.connections ...
  - idx_connections_sender: CREATE INDEX idx_connections_sender ON public.connections ...
  - idx_connections_recipient: CREATE INDEX idx_connections_recipient ON public.connections ...

FOREIGN KEYS:
  - sender_id -> users.id
  - recipient_id -> users.id
  - connection_id -> connection_orders.id
  - technician_id -> technician_orders.id
  - staff_id -> staff_orders.id

CONSTRAINTS:
  - CHECK: 2200_100615_10_not_null
  - CHECK: 2200_100615_1_not_null
  - CHECK: 2200_100615_9_not_null
  - PRIMARY KEY: connections_pkey

================================================================================

TABLE: material_and_technician
Row count: 0
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('mat...
user_id                   bigint                    NULL                      
material_id               bigint                    NULL                      
quantity                  integer                   NULL                      
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - material_and_technician_pkey: CREATE UNIQUE INDEX material_and_technician_pkey ON public.material_and_technician ...

FOREIGN KEYS:
  - user_id -> users.id
  - material_id -> materials.id

CONSTRAINTS:
  - CHECK: 2200_100709_1_not_null
  - CHECK: 2200_100709_5_not_null
  - CHECK: 2200_100709_6_not_null
  - PRIMARY KEY: material_and_technician_pkey

================================================================================

TABLE: material_issued
Row count: 0
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('mat...
material_id               bigint                    NOT NULL                  
quantity                  integer                   NOT NULL                  
price                     numeric(10,2)             NOT NULL                  
total_price               numeric(10,2)             NOT NULL                  
issued_by                 bigint                    NOT NULL                  
issued_at                 timestamp with time zone  NULL       CURRENT_TIME...
notes                     text                      NULL                      
connection_order_id       bigint                    NULL                      
technician_order_id       bigint                    NULL                      
staff_order_id            bigint                    NULL                      
material_name             text                      NULL                      
material_unit             text                      NULL                      
is_approved               boolean                   NULL       false          
approved_by               bigint                    NULL                      
approved_at               timestamp with time zone  NULL                      
is_returned               boolean                   NULL       false          
returned_quantity         integer                   NULL       0              
returned_at               timestamp with time zone  NULL                      
returned_by               bigint                    NULL                      
return_notes              text                      NULL                      
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - material_issued_pkey: CREATE UNIQUE INDEX material_issued_pkey ON public.material_issued ...

FOREIGN KEYS:
  - material_id -> materials.id
  - issued_by -> users.id
  - connection_order_id -> connection_orders.id
  - technician_order_id -> technician_orders.id
  - staff_order_id -> staff_orders.id
  - approved_by -> users.id
  - returned_by -> users.id

CONSTRAINTS:
  - CHECK: 2200_100729_1_not_null
  - CHECK: 2200_100729_22_not_null
  - CHECK: 2200_100729_23_not_null
  - CHECK: 2200_100729_2_not_null
  - CHECK: 2200_100729_3_not_null
  - CHECK: 2200_100729_4_not_null
  - CHECK: 2200_100729_5_not_null
  - CHECK: 2200_100729_6_not_null
  - CHECK: chk_one_order_type
  - CHECK: chk_return_quantity
  - CHECK: material_issued_quantity_check
  - PRIMARY KEY: material_issued_pkey

================================================================================

TABLE: material_requests
Row count: 0
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('mat...
description               text                      NULL                      
user_id                   bigint                    NULL                      
applications_id           bigint                    NULL                      
material_id               bigint                    NULL                      
connection_order_id       bigint                    NULL                      
technician_order_id       bigint                    NULL                      
staff_order_id            bigint                    NULL                      
quantity                  integer                   NULL       1              
price                     numeric                   NULL       0              
total_price               numeric                   NULL       0              
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - material_requests_pkey: CREATE UNIQUE INDEX material_requests_pkey ON public.material_requests ...

FOREIGN KEYS:
  - user_id -> users.id
  - material_id -> materials.id
  - connection_order_id -> connection_orders.id
  - technician_order_id -> technician_orders.id
  - staff_order_id -> staff_orders.id

CONSTRAINTS:
  - CHECK: 2200_100669_12_not_null
  - CHECK: 2200_100669_13_not_null
  - CHECK: 2200_100669_1_not_null
  - PRIMARY KEY: material_requests_pkey

================================================================================

TABLE: materials
Row count: 0
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('mat...
name                      text                      NULL                      
price                     numeric                   NULL                      
description               text                      NULL                      
quantity                  integer                   NULL       0              
serial_number             text                      NULL                      
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - materials_pkey: CREATE UNIQUE INDEX materials_pkey ON public.materials ...
  - materials_serial_number_key: CREATE UNIQUE INDEX materials_serial_number_key ON public.materials ...
  - idx_materials_serial: CREATE INDEX idx_materials_serial ON public.materials ...

CONSTRAINTS:
  - CHECK: 2200_100653_1_not_null
  - CHECK: 2200_100653_7_not_null
  - CHECK: 2200_100653_8_not_null
  - PRIMARY KEY: materials_pkey
  - UNIQUE: materials_serial_number_key

================================================================================

TABLE: media_files
Row count: 0
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('med...
file_path                 text                      NOT NULL                  
file_type                 text                      NULL                      
file_size                 bigint                    NULL                      
original_name             text                      NULL                      
mime_type                 text                      NULL                      
category                  text                      NULL                      
related_table             text                      NULL                      
related_id                bigint                    NULL                      
uploaded_by               bigint                    NULL                      
is_active                 boolean                   NOT NULL   true           
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - media_files_pkey: CREATE UNIQUE INDEX media_files_pkey ON public.media_files ...
  - idx_media_files_related: CREATE INDEX idx_media_files_related ON public.media_files ...

FOREIGN KEYS:
  - uploaded_by -> users.id

CONSTRAINTS:
  - CHECK: 2200_100827_11_not_null
  - CHECK: 2200_100827_12_not_null
  - CHECK: 2200_100827_13_not_null
  - CHECK: 2200_100827_1_not_null
  - CHECK: 2200_100827_2_not_null
  - PRIMARY KEY: media_files_pkey

================================================================================

TABLE: reports
Row count: 0
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('rep...
title                     text                      NOT NULL                  
description               text                      NULL                      
created_by                bigint                    NULL                      
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - reports_pkey: CREATE UNIQUE INDEX reports_pkey ON public.reports ...

FOREIGN KEYS:
  - created_by -> users.id

CONSTRAINTS:
  - CHECK: 2200_100783_1_not_null
  - CHECK: 2200_100783_2_not_null
  - CHECK: 2200_100783_5_not_null
  - CHECK: 2200_100783_6_not_null
  - PRIMARY KEY: reports_pkey

================================================================================

TABLE: smart_service_orders
Row count: 0
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('sma...
application_number        character varying(50)     NULL                      
user_id                   bigint                    NULL                      
category                  USER-DEFINED              NOT NULL                  
service_type              text                      NOT NULL                  
address                   text                      NOT NULL                  
longitude                 double precision          NULL                      
latitude                  double precision          NULL                      
is_active                 boolean                   NOT NULL   true           
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - smart_service_orders_pkey: CREATE UNIQUE INDEX smart_service_orders_pkey ON public.smart_service_orders ...
  - idx_sso_user_id: CREATE INDEX idx_sso_user_id ON public.smart_service_orders ...
  - idx_sso_category: CREATE INDEX idx_sso_category ON public.smart_service_orders ...

FOREIGN KEYS:
  - user_id -> users.id

CONSTRAINTS:
  - CHECK: 2200_100595_10_not_null
  - CHECK: 2200_100595_11_not_null
  - CHECK: 2200_100595_1_not_null
  - CHECK: 2200_100595_4_not_null
  - CHECK: 2200_100595_5_not_null
  - CHECK: 2200_100595_6_not_null
  - CHECK: 2200_100595_9_not_null
  - PRIMARY KEY: smart_service_orders_pkey

================================================================================

TABLE: staff_orders
Row count: 0
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('sta...
application_number        character varying(50)     NULL                      
user_id                   bigint                    NULL                      
phone                     text                      NULL                      
region                    text                      NULL                      
abonent_id                text                      NULL                      
tarif_id                  bigint                    NULL                      
address                   text                      NULL                      
description               text                      NULL                      
business_type             USER-DEFINED              NOT NULL   'B2C'::busin...
status                    USER-DEFINED              NOT NULL   'new'::staff...
type_of_zayavka           USER-DEFINED              NOT NULL   'connection'...
is_active                 boolean                   NOT NULL   true           
created_by_role           USER-DEFINED              NULL                      
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - staff_orders_pkey: CREATE UNIQUE INDEX staff_orders_pkey ON public.staff_orders ...
  - idx_staff_orders_user: CREATE INDEX idx_staff_orders_user ON public.staff_orders ...
  - idx_staff_orders_status: CREATE INDEX idx_staff_orders_status ON public.staff_orders ...

FOREIGN KEYS:
  - user_id -> users.id
  - tarif_id -> tarif.id

CONSTRAINTS:
  - CHECK: 2200_100567_10_not_null
  - CHECK: 2200_100567_11_not_null
  - CHECK: 2200_100567_12_not_null
  - CHECK: 2200_100567_13_not_null
  - CHECK: 2200_100567_15_not_null
  - CHECK: 2200_100567_16_not_null
  - CHECK: 2200_100567_1_not_null
  - PRIMARY KEY: staff_orders_pkey

================================================================================

TABLE: tarif
Row count: 4
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('tar...
name                      text                      NULL                      
picture                   text                      NULL                      
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - tarif_pkey: CREATE UNIQUE INDEX tarif_pkey ON public.tarif ...

CONSTRAINTS:
  - CHECK: 2200_100504_1_not_null
  - CHECK: 2200_100504_4_not_null
  - CHECK: 2200_100504_5_not_null
  - PRIMARY KEY: tarif_pkey

================================================================================

TABLE: technician_orders
Row count: 2
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('tec...
application_number        character varying(50)     NULL                      
user_id                   bigint                    NULL                      
region                    text                      NULL                      
abonent_id                text                      NULL                      
address                   text                      NULL                      
media                     text                      NULL                      
business_type             USER-DEFINED              NOT NULL   'B2C'::busin...
longitude                 double precision          NULL                      
latitude                  double precision          NULL                      
description               text                      NULL                      
description_ish           text                      NULL                      
description_operator      text                      NULL                      
status                    USER-DEFINED              NOT NULL   'in_controll...
is_active                 boolean                   NOT NULL   true           
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - technician_orders_pkey: CREATE UNIQUE INDEX technician_orders_pkey ON public.technician_orders ...
  - idx_technician_orders_user: CREATE INDEX idx_technician_orders_user ON public.technician_orders ...
  - idx_technician_orders_status: CREATE INDEX idx_technician_orders_status ON public.technician_orders ...
  - idx_technician_orders_created: CREATE INDEX idx_technician_orders_created ON public.technician_orders ...

FOREIGN KEYS:
  - user_id -> users.id

CONSTRAINTS:
  - CHECK: 2200_100544_14_not_null
  - CHECK: 2200_100544_15_not_null
  - CHECK: 2200_100544_16_not_null
  - CHECK: 2200_100544_17_not_null
  - CHECK: 2200_100544_1_not_null
  - CHECK: 2200_100544_8_not_null
  - PRIMARY KEY: technician_orders_pkey

================================================================================

TABLE: users
Row count: 2
--------------------------------------------------
Column Name               Type                      Nullable   Default        
---------------------------------------------------------------------------
id                        bigint                    NOT NULL   nextval('use...
telegram_id               bigint                    NULL                      
full_name                 text                      NULL                      
username                  text                      NULL                      
phone                     text                      NULL                      
language                  character varying(5)      NOT NULL   'uz'::charac...
region                    character varying(20)     NULL                      
address                   text                      NULL                      
role                      USER-DEFINED              NULL                      
abonent_id                text                      NULL                      
is_blocked                boolean                   NOT NULL   false          
created_at                timestamp with time zone  NOT NULL   now()          
updated_at                timestamp with time zone  NOT NULL   now()          

INDEXES:
  - users_pkey: CREATE UNIQUE INDEX users_pkey ON public.users ...
  - users_telegram_id_key: CREATE UNIQUE INDEX users_telegram_id_key ON public.users ...
  - idx_users_abonent_id: CREATE INDEX idx_users_abonent_id ON public.users ...
  - idx_users_role: CREATE INDEX idx_users_role ON public.users ...
  - idx_users_id: CREATE INDEX idx_users_id ON public.users ...

CONSTRAINTS:
  - CHECK: 2200_100485_11_not_null
  - CHECK: 2200_100485_12_not_null
  - CHECK: 2200_100485_13_not_null
  - CHECK: 2200_100485_1_not_null
  - CHECK: 2200_100485_6_not_null
  - CHECK: users_region_check
  - PRIMARY KEY: users_pkey
  - UNIQUE: users_telegram_id_key

================================================================================


ALFABOT PROJECT REQUIREMENTS ANALYSIS
================================================================================
Actual tables found in database:
  ✓ akt_documents
  ✓ akt_ratings
  ✓ connection_orders
  ✓ connections
  ✓ material_and_technician
  ✓ material_issued
  ✓ material_requests
  ✓ materials
  ✓ media_files
  ✓ reports
  ✓ smart_service_orders
  ✓ staff_orders
  ✓ tarif
  ✓ technician_orders
  ✓ users

Key features that should be supported:
  - Multi-role user system (admin, client, manager, technician, etc.)
  - Connection order management workflow
  - Technical service order workflow
  - Materials and inventory management
  - Regional service management
  - Status tracking and transitions
  - Telegram bot integration
  - Multi-language support (uz/ru)

================================================================================
END OF ALFABOT REPORT
